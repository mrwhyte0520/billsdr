import{r as g,j as e,D as A}from"./index-CIddALDL.js";import{s as a}from"./database-D6UsPckU.js";const D=[{id:"company",name:"Información de la Empresa",description:"Configurar datos básicos de la empresa, logo y contacto",icon:"ri-building-line",href:"/settings/company"},{id:"accounting",name:"Configuración Contable",description:"Configurar períodos fiscales, monedas y políticas contables",icon:"ri-calculator-line",href:"/settings/accounting"},{id:"taxes",name:"Configuración de Impuestos",description:"Configurar tipos de impuestos, tasas y reglas fiscales",icon:"ri-percent-line",href:"/settings/taxes"},{id:"inventory",name:"Configuración de Inventario",description:"Configurar métodos de valuación, categorías y almacenes",icon:"ri-archive-line",href:"/settings/inventory"},{id:"payroll",name:"Configuración de Nómina",description:"Configurar conceptos de nómina, deducciones y beneficios",icon:"ri-money-dollar-circle-line",href:"/settings/payroll"},{id:"backup",name:"Respaldos y Seguridad",description:"Configurar respaldos automáticos y políticas de seguridad",icon:"ri-shield-check-line",href:"/settings/backup"}];function O(){const[f,j]=g.useState(""),[v,y]=g.useState(!1),[w,h]=g.useState(!1),[n,d]=g.useState(!1),[m,i]=g.useState(null),N=D.filter(s=>s.name.toLowerCase().includes(f.toLowerCase())||s.description.toLowerCase().includes(f.toLowerCase())),S=s=>{window.REACT_APP_NAVIGATE(s)},C=async()=>{d(!0),i(null);try{const[s,u,x,r,t,o,l,c]=await Promise.all([a.getCompanyInfo(),a.getAccountingSettings(),a.getTaxSettings(),a.getInventorySettings(),a.getPayrollSettings(),a.getTaxRates(),a.getWarehouses(),a.getPayrollConcepts()]),R={exportInfo:{exportDate:new Date().toISOString(),version:"1.0",systemName:"Contabi RD",description:"Configuración completa del sistema contable"},companyInfo:s||null,accountingSettings:u||null,taxSettings:x||null,inventorySettings:r||null,payrollSettings:t||null,taxRates:o||[],warehouses:l||[],payrollConcepts:c||[]},k=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),b=URL.createObjectURL(k),p=document.createElement("a");p.href=b,p.download=`contabi-configuracion-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(b),i({type:"success",text:"Configuración exportada exitosamente. El archivo se ha descargado."})}catch(s){console.error("Error exporting configuration:",s),i({type:"error",text:"Error al exportar la configuración. Inténtalo de nuevo."})}finally{d(!1)}},_=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async u=>{const x=u.target.files?.[0];if(x){d(!0),i(null);try{const r=await x.text(),t=JSON.parse(r);if(!t.exportInfo||!t.exportInfo.version)throw new Error("Archivo de configuración inválido o corrupto");if(t.exportInfo.systemName!=="Contabi RD")throw new Error("Este archivo no es compatible con Contabi RD");let o=0;if(t.companyInfo&&(await a.saveCompanyInfo(t.companyInfo),o++),t.accountingSettings&&(await a.saveAccountingSettings(t.accountingSettings),o++),t.taxSettings&&(await a.saveTaxSettings(t.taxSettings),o++),t.inventorySettings&&(await a.saveInventorySettings(t.inventorySettings),o++),t.payrollSettings&&(await a.savePayrollSettings(t.payrollSettings),o++),t.taxRates&&Array.isArray(t.taxRates))for(const l of t.taxRates)try{await a.createTaxRate(l)}catch(c){console.warn("Tax rate already exists or error creating:",c)}if(t.warehouses&&Array.isArray(t.warehouses))for(const l of t.warehouses)try{await a.createWarehouse(l)}catch(c){console.warn("Warehouse already exists or error creating:",c)}if(t.payrollConcepts&&Array.isArray(t.payrollConcepts))for(const l of t.payrollConcepts)try{await a.createPayrollConcept(l)}catch(c){console.warn("Payroll concept already exists or error creating:",c)}i({type:"success",text:`Configuración importada exitosamente. ${o} secciones actualizadas.`})}catch(r){console.error("Error importing configuration:",r);let t="Error al importar la configuración.";r instanceof SyntaxError?t="El archivo seleccionado no es un JSON válido.":r instanceof Error&&(t=r.message),i({type:"error",text:t})}finally{d(!1)}}},s.click()},I=async()=>{d(!0);try{const s={fiscal_year_start:"2024-01-01",fiscal_year_end:"2024-12-31",default_currency:"DOP",decimal_places:2,date_format:"DD/MM/YYYY",number_format:"1,234.56",auto_backup:!0,backup_frequency:"daily",retention_period:30},u={itbis_rate:18,isr_rate:27,retention_rate:10,declaration_frequency:"monthly",fiscal_year_start:"2024-01-01",fiscal_year_end:"2024-12-31"},x={valuation_method:"FIFO",auto_reorder:!1,track_serial_numbers:!1,track_expiration_dates:!1,default_warehouse:"Principal"},r={pay_frequency:"monthly",overtime_rate:1.5,social_security_rate:2.87,afp_rate:2.87,sfs_rate:3.04,christmas_bonus:!0,vacation_days:14};await Promise.all([a.saveAccountingSettings(s),a.saveTaxSettings(u),a.saveInventorySettings(x),a.savePayrollSettings(r)]),i({type:"success",text:"Configuración restablecida a valores por defecto del sistema"}),h(!1)}catch(s){console.error("Error resetting configuration:",s),i({type:"error",text:"Error al restablecer la configuración"})}finally{d(!1)}},E=[{id:"1",section:"Información de la Empresa",action:"Actualización",user:"Admin",timestamp:new Date().toISOString(),details:"Actualizado nombre de la empresa y dirección"},{id:"2",section:"Configuración de Impuestos",action:"Modificación",user:"Contador",timestamp:new Date(Date.now()-864e5).toISOString(),details:"Modificada tasa de ITBIS de 18% a 18%"},{id:"3",section:"Gestión de Usuarios",action:"Creación",user:"Admin",timestamp:new Date(Date.now()-1728e5).toISOString(),details:"Creado nuevo usuario con rol de Contador"}];return g.useState(()=>{if(m){const s=setTimeout(()=>{i(null)},5e3);return()=>clearTimeout(s)}}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-6",children:[m&&e.jsx("div",{className:`p-4 rounded-lg ${m.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`${m.type==="success"?"ri-check-circle-line":"ri-error-warning-line"} mr-2`}),m.text]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuración del Sistema"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Administra la configuración general de tu sistema contable"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"ri-search-line text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Buscar configuración...",value:f,onChange:s=>j(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(s=>e.jsx("div",{onClick:()=>S(s.href),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer group",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:e.jsx("i",{className:`${s.icon} text-blue-600 text-xl`})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"mt-3 flex items-center text-sm text-blue-600 group-hover:text-blue-700",children:[e.jsx("span",{children:"Configurar"}),e.jsx("i",{className:"ri-arrow-right-line ml-1"})]})]})]})},s.id))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Acciones Rápidas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:C,disabled:n,className:"flex items-center justify-center space-x-2 bg-green-50 text-green-700 px-4 py-3 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:`${n?"ri-loader-4-line animate-spin":"ri-download-line"}`}),e.jsx("span",{children:n?"Exportando...":"Exportar Configuración"})]}),e.jsxs("button",{onClick:_,disabled:n,className:"flex items-center justify-center space-x-2 bg-blue-50 text-blue-700 px-4 py-3 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:`${n?"ri-loader-4-line animate-spin":"ri-upload-line"}`}),e.jsx("span",{children:n?"Importando...":"Importar Configuración"})]}),e.jsxs("button",{onClick:()=>h(!0),disabled:n,className:"flex items-center justify-center space-x-2 bg-orange-50 text-orange-700 px-4 py-3 rounded-lg hover:bg-orange-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:"ri-refresh-line"}),e.jsx("span",{children:"Restablecer Valores"})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center justify-center space-x-2 bg-purple-50 text-purple-700 px-4 py-3 rounded-lg hover:bg-purple-100 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-history-line"}),e.jsx("span",{children:"Historial de Cambios"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado del Sistema"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Base de Datos"}),e.jsx("p",{className:"text-xs text-green-700",children:"Conectada y funcionando"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Respaldos"}),e.jsx("p",{className:"text-xs text-green-700",children:"Último: Hoy 03:00 AM"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Actualizaciones"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"1 actualización disponible"})]})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Historial de Cambios"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.section}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.action==="Creación"?"bg-green-100 text-green-800":s.action==="Actualización"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:s.action})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.details}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Por: ",s.user]}),e.jsx("span",{children:new Date(s.timestamp).toLocaleString("es-DO")})]})]})})},s.id))})})]})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-alert-line text-orange-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Confirmar Restablecimiento"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"¿Estás seguro de que deseas restablecer todas las configuraciones a sus valores por defecto del sistema? Esta acción no se puede deshacer."}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:I,disabled:n,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Restableciendo...":"Restablecer"})]})]})})})]})})}export{O as default};
//# sourceMappingURL=page-DzdQ3QiT.js.map
